function getUrlParameter(e){if(window.location.getParameter)return window.location.getParameter(e);if(location.search)for(var t=location.search.substring(1).split("&"),n=0;n<t.length;n++){var i=t[n].split("=");if(i[0]&&i[0]==e)return i[1]||!0}}function generateUUID(){var e=(new Date).getTime();window.performance&&"function"==typeof window.performance.now&&(e+=performance.now());var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t}function clamp(e,t,n){return e<=t?t:e>=n?n:e}var DIRECTION={left:37,up:38,right:39,down:40,leftup:3738,rightup:3938,leftdown:3740,rightdown:3940,none:0,horizontal:1,vertical:2},KEY={left:37,up:38,right:39,down:40,space:32,ctrl:17,enter:13,action:1e3},EVENT={keyDown:1,keyUp:2,select:3,screenUpdate:4,tick:5,step:6},EventBus=function(){var e={},t={};return t.onEvent=function(t,n){var i=e[t];i||(i=[],e[t]=i),i.push(n)},t.sendEvent=function(t,n){var i=e[t];if(i){var r,a=i.length;for(r=0;r<a;r++)i[r](n,t)}},t.trigger=function(e,n){t.sendEvent(e,n)},t.on=function(e,n){t.onEvent(e,n)},t}(),Yascal=function(){var e={};return e.init=function(t){e.screen.init(t),e.touchInput.init(e.canvas)},e.sprites={},e.getImage=function(t){return e.sprites[t]?e.sprites[t].canvas:void 0},e.loadImage=function(e,t){var n=new Image;n.onload=function(){t&&t(n)},n.onerror=function(){},n.src=e},e.getModalElement=function(){},e.getEventElement=function(t,n){for(var i=void 0,r=0,a=e.screen.children.length;r<a;r++){var o=e.screen.children[r];if(o.isVisible()&&o.containsPoint(t,n)){i=o;break}}return i&&i.children&&i.children.length&&(i=i.getElementAtPoint(t,n)),i},e}(),Y=Yascal;Yascal.properties=function(e){if(e&&e.isYascal)return e;var t=e||{};return t.isYascal=!0,t.get=function(e,n){return"undefined"==typeof t[e]?n:t[e]},t.set=function(e,n){t[e]=n},t.has=function(e){return"undefined"!=typeof t[e]},t},Yascal.util=function(e){var t={};return t}(),Yascal.screen=function(e){var t={};e=Y.properties(e),t.name="mainScreen",t.visible=!0,t.children=[];var r,a,c,d,n=[],i={},o=!0,s=1,u=1,l="black",h=0;return t.init=function(){r=e.canvas||document.createElement("canvas"),a=r.getContext("2d"),Y.canvas=t.canvas=r,Y.ctx=t.ctx=a,t.render()},t.setSize=function(e,n){r.width=t.width=e,r.height=t.height=n},t.setScaleFactor=function(e){s=r.offsetWidth/r.width,u=r.offsetHeight/r.height,e&&window.addEventListener("resize",function(){t.setScaleFactor()},!0)},t.getScaleFactor=function(){return{width:s,height:u}},t.windowToCanvas=function(e,t){return{x:e/s,y:t/u}},t.canvasToWindow=function(e,t){return{x:e*s,y:t*u}},t.scaledX=function(e){return Math.round(e/s)},t.scaledY=function(e){return Math.round(e/u)},t.setProperties=function(e){e=Y.properties(e),l=e.get("backGroundColor",l),d=e.get("backGroundImage",d)},t.clear=function(){a.fillStyle=l,a.clearRect(0,0,t.width,t.height),a.fillRect(0,0,t.width,t.height),d&&a.drawImage(d,0,0,t.width,t.height)},t.clearBackGroundImage=function(){d=void 0},t.refresh=function(){o=!0},t.addChild=function(e){e.setParent(t),e.zIndex=e.zIndex||t.children.length,t.children.push(e),o=!0},t.render=function(e){var r=!0;if(r){var a=e-h;if(h=e,a<10)return;a>1e3&&(a=16),a||(a=16),EventBus.trigger(EVENT.screenUpdate,a),n.forEach(function(t,r){if(t.canceled)delete i[t.id],n.splice(r,1);else{var a=e-t.start,c=Math.min(a/t.duration,1),s=t.easing||Yascal.easing.easeOutQuad,u=s(c);t.updatefunction(t.initialState,u),o=!0,1==c&&n.splice(r,1)}}),o&&(t.clear(),t.children.forEach(function(e){e.render()}),c&&(c.render(),o=!1),o=!1)}window.requestAnimationFrame(t.render)},t.registerAnimation=function(e,t,r,a){if(t){var o={id:generateUUID(),start:performance.now(),duration:1e3*t,easing:a,initialState:e,updatefunction:r};return n.push(o),i[o.id]=o,o.id}return!1},t.cancelAnimation=function(e){var t=i[e];t&&(t.canceled=!0)},t}(),Yascal.screen=function(e){var t={};e=Y.properties(e),t.name="mainScreen",t.visible=!0,t.children=[];var r,a,c,d,n=[],i={},o=!0,s=1,u=1,l="black",h=0;return t.init=function(){r=e.canvas||document.createElement("canvas"),a=r.getContext("2d"),Y.canvas=t.canvas=r,Y.ctx=t.ctx=a,t.render()},t.setSize=function(e,n){r.width=t.width=e,r.height=t.height=n},t.setScaleFactor=function(e){s=r.offsetWidth/r.width,u=r.offsetHeight/r.height,e&&window.addEventListener("resize",function(){t.setScaleFactor()},!0)},t.getScaleFactor=function(){return{width:s,height:u}},t.windowToCanvas=function(e,t){return{x:e/s,y:t/u}},t.canvasToWindow=function(e,t){return{x:e*s,y:t*u}},t.scaledX=function(e){return Math.round(e/s)},t.scaledY=function(e){return Math.round(e/u)},t.setProperties=function(e){e=Y.properties(e),l=e.get("backGroundColor",l),d=e.get("backGroundImage",d)},t.clear=function(){a.fillStyle=l,a.clearRect(0,0,t.width,t.height),a.fillRect(0,0,t.width,t.height),d&&a.drawImage(d,0,0,t.width,t.height)},t.clearBackGroundImage=function(){d=void 0},t.refresh=function(){o=!0},t.addChild=function(e){e.setParent(t),e.zIndex=e.zIndex||t.children.length,t.children.push(e),o=!0},t.render=function(e){var r=!0;if(r){var a=e-h;if(h=e,a<10)return;a>1e3&&(a=16),a||(a=16),EventBus.trigger(EVENT.screenUpdate,a),n.forEach(function(t,r){if(t.canceled)delete i[t.id],n.splice(r,1);else{var a=e-t.start,c=Math.min(a/t.duration,1),s=t.easing||Yascal.easing.easeOutQuad,u=s(c);t.updatefunction(t.initialState,u),o=!0,1==c&&n.splice(r,1)}}),o&&(t.clear(),t.children.forEach(function(e){e.render()}),c&&(c.render(),o=!1),o=!1)}window.requestAnimationFrame(t.render)},t.registerAnimation=function(e,t,r,a){if(t){var o={id:generateUUID(),start:performance.now(),duration:1e3*t,easing:a,initialState:e,updatefunction:r};return n.push(o),i[o.id]=o,o.id}return!1},t.cancelAnimation=function(e){var t=i[e];t&&(t.canceled=!0)},t}(),Yascal.sprite=function(e){var t={};if(t.canvas=document.createElement("canvas"),t.ctx=t.canvas.getContext("2d"),e&&(e.width&&(t.canvas.width=e.width,t.canvas.height=e.height||e.width),e.img)){var n=e.x||0,i=e.y||0,r=t.canvas.width,a=t.canvas.height;t.ctx.drawImage(e.img,n,i,r,a,0,0,r,a)}return t},Y.spriteSheet=function(){var e={};return e.sprites=[],e.loadFromImage=function(t,n,i){var r,a=function(){i&&i()};if(!n)return void a();var o=function(t){if(n.tileWidth&&n.tileHeight){for(var i=n.tileWidth,r=n.tileHeight,o=Math.floor(t.width/i),c=Math.floor(t.height/r),s=o*c,u=0;u<s;u++){var l={width:i,height:r,img:t,x:u%o*i,y:Math.floor(u/o)*r};e.sprites.push(new Y.sprite(l))}a()}};"string"==typeof t?Y.loadImage(t,function(e){r=e,o(r)}):o(t)},e},Yascal.easing=function(){var e={};return e.linear=function(e){return e},e.easeInSine=function(e){return-1*Math.cos(e*(Math.PI/2))+1},e.easeOutSine=function(e){return Math.sin(e*(Math.PI/2))},e.easeInOutSine=function(e){return-.5*(Math.cos(Math.PI*e)-1)},e.easeInQuad=function(e){return e*e},e.easeOutQuad=function(e){return e*(2-e)},e.easeInOutQuad=function(e){return.5>e?2*e*e:-1+(4-2*e)*e},e.easeInCubic=function(e){return e*e*e},e.easeOutCubic=function(e){var t=e-1;return t*t*t+1},e.easeOutQuint=function(e){var t=e-1;return 1+t*t*t*t*t},e.easeOutCirc=function(e){var t=e-1;return Math.sqrt(1-t*t)},e.easeOutElastic=function(e){var t=arguments.length<=1||void 0===arguments[1]?.7:arguments[1],n=1-t,i=2*e;if(0===e||1===e)return e;var r=n/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*i)*Math.sin((i-r)*(2*Math.PI)/n)+1},e.easeOutBounce=function(e){var t=e/1;if(1/2.75>t)return 7.5625*t*t;if(2/2.75>t){var n=t-1.5/2.75;return 7.5625*n*n+.75}if(2.5/2.75>t){var i=t-2.25/2.75;return 7.5625*i*i+.9375}var r=t-2.625/2.75;return 7.5625*r*r+.984375},e.easeInOutBounce=function(e){return.5>e?.5*_(2*e):.5*easeOutBounce(2*e-1)+.5},e}(),Yascal.keyInput=function(){function n(e){var n=e.keyCode;t[n]=a(n),t[n].isDown=!0,n!=KEY.space&&n!=KEY.ctrl&&n!=KEY.enter||(t[KEY.action]=a(KEY.action),t[KEY.action].isDown=!0),"undefined"!=typeof EventBus&&EventBus.trigger(EVENT.keyDown,n)}function i(e){var n=e.keyCode;t[n]=a(n),t[n].isDown=!1,n!=KEY.space&&n!=KEY.ctrl&&n!=KEY.enter||(t[KEY.action]=a(KEY.action),t[KEY.action].isDown=!1),"undefined"!=typeof EventBus&&EventBus.trigger(EVENT.keyUp,n)}function a(e){return t[e]||{}}var e={},t={};return document.addEventListener("keydown",n,!1),document.addEventListener("keyup",i,!1),e.isDown=function(t){return e.isKeyDown(KEY.down,t)},e.isUp=function(t){return e.isKeyDown(KEY.up,t)},e.isLeft=function(t){return e.isKeyDown(KEY.left,t)},e.isRight=function(t){return e.isKeyDown(KEY.right,t)},e.isAction=function(t){return e.isKeyDown(KEY.action,t)},e.isEnter=function(t){return e.isKeyDown(KEY.enter,t)},e.isKeyDown=function(e,n){return t[e]=a(e),"undefined"!=typeof n&&(t[e].isDown=n),t[e].isDown},e}(),Yascal.touchInput=function(){function r(e){function s(e,n,r){t.isTouchDown=!0;var a=i.getBoundingClientRect();n=Y.screen.scaledX(n-a.left),r=Y.screen.scaledY(r-a.top),currentEventTarget=Y.getModalElement()||Y.getEventElement(n,r);var o={id:e,x:n,y:r,startX:n,startY:r,UIobject:currentEventTarget};t.touches.push(o),o.UIobject&&(o.UIobject.onDragStart&&o.UIobject.onDragStart(o),o.UIobject.onTouchDown&&o.UIobject.onTouchDown(o))}if(e.preventDefault(),n||(n=!0),e.touches&&e.touches.length>0)for(var r=e.changedTouches,a=0;a<r.length;a++){var o=r[a];s(o.identifier,o.pageX,o.pageY)}else{var c=d("notouch");c>=0&&t.touches.splice(c,1),s("notouch",e.pageX,e.pageY)}}function a(e){function l(e,n,i){if(e>=0){var r=t.touches[e];r.x=n,r.y=i,t.touches.splice(e,1,r),t.isTouchDown&&r.UIobject&&r.UIobject.onDrag&&(r.dragX=n,r.dragY=i,r.isDragging=!0,r.UIobject.onDrag(r))}}e.preventDefault();var a,o,n=i.getBoundingClientRect();if(e.touches&&e.touches.length>0)for(var c=e.changedTouches,s=0;s<c.length;s++){var u=c[s];a=Y.screen.scaledX(u.pageX-n.left),o=Y.screen.scaledY(u.pageY-n.top),l(d(u.identifier),a,o)}else a=Y.screen.scaledX(e.pageX-n.left),o=Y.screen.scaledY(e.pageY-n.top),l(d("notouch"),a,o),t.currentMouseX=a,t.currentMouseY=o,t.mouseMoved=(new Date).getTime()}function o(e){function a(e){if(e>=0){var n=t.touches[e];if(n.UIobject){var i=n.UIobject;if(i.onClick){var r=n.startX-n.x,a=n.startY-n.y,o=Math.sqrt(r*r+a*a);o<8&&i.onClick(n)}i.onDragEnd&&i.onDragEnd(n),i.onTouchUp&&i.onTouchUp(n)}t.touches.splice(e,1)}}function o(){}if(t.isTouchDown=!1,e&&e.touches){for(var n=e.changedTouches,i=0;i<n.length;i++){var r=n[i];a(d(r.identifier))}0==e.touches.length&&o()}else a(d("notouch")),o()}function c(e){if(t.currentMouseX){var n=t.currentMouseX,i=t.currentMouseY,r=Y.getEventElement(n,i);if(r&&r.onMouseWheel){var a=e.wheelDeltaY||e.wheelDelta||-e.detail;e.wheelDeltaX||0;t.mouseWheels.unshift(a),t.mouseWheels.length>10&&t.mouseWheels.pop(),r.onMouseWheel(t)}}}function s(e){e.stopPropagation(),e.preventDefault()}function u(e){e.stopPropagation(),e.preventDefault()}function l(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer,n=t.files;Tracker.handleUpload(n)}var e={},t={};t.touches=[],t.mouseWheels=[];var i,n=!1;e.init=function(e){i=e,i.addEventListener("mousedown",r,!1),i.addEventListener("mousemove",a,!1),i.addEventListener("mouseup",o,!1),i.addEventListener("touchstart",r,!1),i.addEventListener("touchmove",a,!1),i.addEventListener("touchend",o,!1),window.navigator.msPointerEnabled&&(i.addEventListener("MSPointerDown",r,!1),i.addEventListener("MSPointerMove",a,!1),i.addEventListener("MSPointerEnd",o,!1)),i.addEventListener("mousewheel",c,!1),i.addEventListener("DOMMouseScroll",c,!1),i.addEventListener("dragenter",s,!1),i.addEventListener("dragover",u,!1),i.addEventListener("drop",l,!1)};var d=function(e){for(var n=0;n<t.touches.length;n++)if(t.touches[n].id===e)return n;return-1};return e}(),Yascal.ticker=function(){var n,e={},t=8,i=[],r=1e3/t,a=0,o=0,c=0;return e.start=function(){a=0,EventBus.on(EVENT.screenUpdate,function(e){if(n){var t=1e3/e,s=i.unshift(t);s>10&&i.pop()}a+=e,o+=e,EventBus.trigger(EVENT.tick,e),a>r&&(c++,a=0,EventBus.trigger(EVENT.step))})},e.stats=function(e){e&&(n=!0);for(var t=0,r=i.length,a=0;a<r;a++)t+=i[a];return t=Math.round(t/r)},e},Yascal.element=function(e){var t={};e=e||{},t.left=e.left||0,t.top=e.top||0,t.width=e.width||20,t.height=e.height||20,t.scale=1,t.visible=!0,t.needsRendering=!0,t.parentCtx=Y.ctx,t.canvas=document.createElement("canvas"),t.canvas.width=t.width,t.canvas.height=t.height,t.ctx=t.canvas.getContext("2d"),t.children=[],t.id=generateUUID();var n,i,r;return t.hide=function(e){t.visible=!1,e&&t.refresh()},t.show=function(e,n){t.visible=!0,e&&t.refresh(n)},t.toggle=function(){t.visible?t.hide():t.show()},t.isVisible=function(){for(var e=t.visible,n=t.parent;e&&n;)e=n.visible,n=n.parent;return e},t.containsPoint=function(e,t){var n=this.left,i=this.left+this.width,r=this.top,a=this.top+this.height;return e>=n&&e<=i&&t>=r&&t<=a},t.getElementAtPoint=function(e,n){e-=t.left,n-=t.top;for(var i,r=t.children.length-1;r>=0;r--){var a=t.children[r];if(a.isVisible()&&!a.ignoreEvents&&a.containsPoint(e,n)){i=a;break}}if(i){var o=i.getElementAtPoint(e,n);o?i=o:(i.eventX=e,i.eventY=n)}else i=t,i.eventX=e,i.eventY=n;return i},t.setParent=function(e){t.parent=e,e&&(t.parentCtx=e.ctx)},t.addChild=function(e){e.setParent(t),e.zIndex=e.zIndex||t.children.length,t.children.push(e)},t.getChild=function(e){for(var i,n=t.children.length;n;){if(i=t.children[n],i&&i.name&&i.name==e)return i;n--}},t.refresh=function(e){if(t.needsRendering=!0,e)for(var i,n=t.children.length;n;)i=t.children[n],i&&i.refresh(),n--;this.visible&&t.parent&&t.parent.refresh&&t.parent.refresh()},t.setSize=function(e,n){t.width=e,t.height=n,t.canvas.width=t.width,t.canvas.height=t.height,t.refresh()},t.setPosition=function(e,n){t.left=e,t.top=n,t.refresh()},t.setScale=function(e){t.scale=e,t.refresh()},t.moveTo=function(e,i,r,a){n&&(Y.screen.cancelAnimation(n),n=!1),r?n=Y.screen.registerAnimation({left:t.left,top:t.top},r,function(n,r){var a=(e-n.left)*r,o=(i-n.top)*r;t.setPosition(n.left+a,n.top+o)},a):t.setPosition(e,i)},t.scaleTo=function(e,n,i){r&&(Y.screen.cancelAnimation(r),r=!1),n?r=Y.screen.registerAnimation({scale:t.scale},n,function(n,i){var r=(e-n.scale)*i;t.setScale(n.scale+r)},i):t.setScale(e)},t.clipTo=function(e,n,r,a,o){i&&(Y.screen.cancelAnimation(i),i=!1),r?i=Y.screen.registerAnimation({width:t.width,height:t.height},r,function(i,r){var a=(e-i.width)*r,c=(n-i.height)*r;t.setSize(i.width+a,i.height+c),1==r&&o&&o()},a):t.setSize(e,n)},t.clearCanvas=function(){t.ctx.clearRect(0,0,t.width,t.height)},t},Yascal.panel=function(e){e=Y.properties(e);var t=Yascal.element(e);t.type="panel";var n=["left","top","width","height","name","type","zIndex","backgroundColor","backgroundImage"];return t.setProperties=function(e){n.forEach(function(n){"undefined"!=typeof e[n]&&(t[n]=e[n])}),t.setSize(t.width,t.height),t.setPosition(t.left,t.top),t.setLayout&&t.setLayout(t.left,t.top,t.width,t.height)},t.render=function(e){if(t.isVisible())return e=!!e,this.needsRendering&&(t.clearCanvas(),t.backgroundColor&&(t.ctx.fillStyle=t.backgroundColor,t.ctx.fillRect(0,0,t.width,t.height)),t.backgroundImage&&t.ctx.drawImage(t.backgroundImage,0,0,t.width,t.height),this.children.forEach(function(e){e.render()}),t.renderInternal&&t.renderInternal()),this.needsRendering=!1,e?t.canvas:void t.parentCtx.drawImage(t.canvas,t.left,t.top,t.width,t.height)},t.onClick=function(){},t.sortZIndex=function(){this.children.sort(function(e,t){return e.zIndex==t.zIndex?0:e.zIndex>t.zIndex||-1})},e&&t.setProperties(e),t},Yascal.listbox=function(e){function k(e){C=!0,s=e,d&&Y.screen.cancelAnimation(d),l||(g=r*I,v=g-(i.length-1)*I,l=Y.screen.registerAnimation(0,1/0,function(){u+=s,u=clamp(u,v,g);var e=s>0?1:-1,n=Math.abs(s);n<f&&(n+=p),s=e*n,t.refresh()}))}function P(){}function U(){var e=i.length-1;return t.centerSelection||(e=i.length-a),e}e=Y.properties(e);var t=Y.element(e);t.selectedIndex=0;var o,s,l,d,h,g,v,m,x,I,D,b,n=0,i=[],r=0,a=0,u=0,f=10,p=.2,w=2,E=DIRECTION.vertical,S=0,M=!1,C=!1;t.innerLeft=0,t.innerTop=0;var y=["left","top","width","height","name","type","onChange","selectedIndex","centerSelection","backgroundColor","renderFunction"];e.get("useScrollBar",!0);return t.setProperties=function(e){e=Y.properties(e),y.forEach(function(n){e.has(n)&&(t[n]=e[n])}),m=e.get("itemHeight",m),x=e.get("itemWidth",x),E=e.get("orientation",E),w=e.get("initialSpeed",w),p=e.get("acceleration",p),f=e.get("maxScrollSpeed",f),D=e.get("selectionWidth",D),b=e.get("selectionHeight",b),M=e.get("smoothDrag",M),t.setSize(t.width,t.height),t.setPosition(t.left,t.top),x||(x=t.width),m||(m=t.height),D||(D=x),b||(b=m),t.centerSelection&&(E==DIRECTION.horizontal?t.innerLeft=Math.ceil((t.width-x)/2):t.innerTop=Math.ceil((t.height-m)/2)),I=E==DIRECTION.horizontal?x:m},t.setSelectedIndex=function(e,i){t.selectedIndex=e,t.centerSelection&&(r=t.selectedIndex),t.refresh(),!i&&t.onChange&&n!=t.selectedIndex&&t.onChange(),n=t.selectedIndex},t.getSelectedIndex=function(){return t.selectedIndex},t.getSelectedItem=function(){return i[t.selectedIndex]},t.navigateUp=function(e){e?s<0||k(-w):(r>0&&(r--,P()),t.centerSelection?t.setSelectedIndex(r):t.refresh())},t.navigateDown=function(e){e?s>0||k(w):(r<U()&&(r++,P()),t.centerSelection?t.setSelectedIndex(r):t.refresh())},t.navigateLeft=t.navigateUp,t.navigateRight=t.navigateDown,t.stopNavigation=function(e){if(C){if(C=!1,l&&Y.screen.cancelAnimation(l),l=!1,u){var n=Math.floor(-u/I+r);u%I!=0&&s<0&&n++,n=clamp(n,0,i.length-1),t.moveToIndex(n)}s=0}},t.moveToIndex=function(e,n){e=clamp(e,0,i.length-1),l&&Y.screen.cancelAnimation(l),d&&Y.screen.cancelAnimation(d),s=0;var r=0-(e-t.selectedIndex)*I-u;d=Y.screen.registerAnimation(u,.5,function(i,a){u=i+r*a,1==a&&(u=0,t.setSelectedIndex(e),n&&n()),t.refresh()})},t.selectItem=function(){Y.screen.registerAnimation(1,.5,function(e,n){S=.4*(1-n),t.refresh()})},t.render=function(e){if(e=!!e,this.needsRendering){if(t.backgroundColor&&(t.ctx.fillStyle=t.backgroundColor,t.ctx.fillRect(0,0,t.width,t.height)),h&&h.render(),t.renderSelectionHighLight)t.renderSelectionHighLight(S);else{var n=t.innerLeft-(D-x)/2,a=t.innerTop-(b-m)/2;t.ctx.fillStyle="rgba(255,255,255,"+(.2+S)+")",t.ctx.fillRect(n,a,D,b)}for(var c=0,s=i.length;c<s;c++){var l=i[c],d=0,f=0;if(E==DIRECTION.horizontal?d=t.innerLeft+(c-r)*x+u:f=t.innerTop+(c-r)*m+u,f>-m&&f<t.height&&d>-x&&d<t.width)if(t.renderFunction)t.renderFunction(l,d,f);else{var g=10,v=10;l.level&&(g+=l.level*v),l.icon&&(t.ctx.drawImage(l.icon,g,f-2),g+=l.icon.width+4),t.ctx.fillStyle="white",t.ctx.fillText(l.label,g,f),f+=11}}o&&o.render()}return this.needsRendering=!1,e?t.canvas:void t.parentCtx.drawImage(t.canvas,t.left,t.top,t.width,t.height)},t.setItems=function(e){i=e,r=Math.min(r,U()+1),t.selectedIndex=0,P(),t.refresh()},t.getItems=function(){return i},t.getItemAtPosition=function(e,n,a){var o=0;return E==DIRECTION.horizontal?(e-=t.innerLeft,o=Math.floor(e/I)+r):(n-=t.innerTop,o=Math.floor(n/I)+r),o>=0&&o<i.length?a?o:i[o]:void 0},t.getItemIndexAtPosition=function(e,n){return t.getItemAtPosition(e,n,!0)},t.onMouseWheel=function(e){e.mouseWheels[0]>0?t.navigateUp():t.navigateDown()},t.onDragStart=function(e){t.startDragIndex=r},t.onDrag=function(e){var n;M?(n=E==DIRECTION.horizontal?e.dragX-e.startX:e.dragY-e.startY,u=n,t.refresh()):i.length>a&&(n=Math.round((e.dragY-e.startY)/m),r=t.startDragIndex-n,r=Math.max(r,0),r=Math.min(r,U()),t.centerSelection&&t.setSelectedIndex(r),P())},t.onDragEnd=function(e){if(Math.abs(u)>8){var n=Math.floor(-u/I+r);u%I!=0&&u<0&&n++,n=clamp(n,0,i.length-1),t.moveToIndex(n)}else t.onClick&&t.onClick(e)},t.setSelectionAlpha=function(e){S=e},t},Yascal.stats=function(e){var t=100,n=20,i=Yascal.element({width:t,height:n});return i.type="stats",i.backGroundColor="blue",i.render=function(t){if(i.isVisible())return t=!!t,this.needsRendering&&(i.clearCanvas(),i.backgroundColor&&(i.ctx.fillStyle=i.backgroundColor,i.ctx.fillRect(0,0,i.width,i.height)),e&&(i.ctx.fillStyle="white",i.ctx.font="16px Arial",i.ctx.fillText(e.stats(),10,16))),t?i.canvas:void i.parentCtx.drawImage(i.canvas,i.left,i.top,i.width,i.height)},i.onClick=function(){},i.sortZIndex=function(){this.children.sort(function(e,t){return e.zIndex==t.zIndex?0:e.zIndex>t.zIndex||-1})},i};